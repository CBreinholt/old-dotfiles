#!/bin/bash

SRC=("bin" "boot" "etc" "home" "lib" "lib64" "lost+found" "opt" "root" "sbin" "srv" "usr" "var")
DEST="$(echo "${1:-$PWD}/system_backup" | sed 's/[^a-zA-z]*$/\//')"

echo "==>  Starting system backup to $DEST"
for dir in "${SRC[@]}"; do
    [[ -r "/$dir"  &&  -s "/$dir" ]] && \
        $(mkdir -p $DEST$dir && echo "==>  Backing up /$dir to $DEST$dir" || echo "ERROR: /$dir does not exist!") && \
        $(rsync -anq "/$dir" "$DEST$dir")
done

#mkdir -p $DEST
#rsync -anq --exclude={"/dev/*","/proc/*","/sys/*","/tmp/*","/run/*","/mnt/*","/media/*","/swapfile","/boot/*","/home/*","/lost+found"} \
    #/ $DEST
    #--info=progress2 / $DEST

#echo "==>  Saving / to $DEST/boot"
#rsync -aHAXS --info=progress2 /boot $DEST/boot

#echo "==>  Saving / to $DEST/home"
#rsync -aHAXS --info=progress2 /home $DEST/home
